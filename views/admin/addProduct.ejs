<%- include('partials/header')%>

<link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css" rel="stylesheet">
  <style>
    .page {
      margin: 1em auto;
      max-width: 768px;
      display: flex;
      align-items: flex-start;
      flex-wrap: wrap;
      height: 100%;
    }

    .box {
      padding: 0.5em;
      width: 100%;
      margin: 0.5em;
    }

    .box-2 {
      padding: 0.5em;
      width: calc(100% / 2 - 1em);
    }

    .options label,
    .options input {
      width: 4em;
      padding: 0.5em 1em;
    }

    .btn {
      background: white;
      color: black;
      border: 1px solid black;
      padding: 0.5em 1em;
      text-decoration: none;
      margin: 0.8em 0.3em;
      display: inline-block;
      cursor: pointer;
    }

    .hide {
      display: none;
    }

    img {
      max-width: 100%;
    }
</style>
<body class="with-welcome-text">
    <div class="container-scroller">
      
      <!-- partial:partials/_navbar.html -->
      <%- include('partials/navbar')%>
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:partials/_sidebar.html -->
        <%- include('partials/sidebar')%>

        <div class="main-panel">
          <div class="content-wrapper">
            <div class="row">
<div class="col-12 grid-margin">
 
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">Add Products</h4>
        <form action="/admin/addProduct" method="post" class="form-sample">
          <p class="card-description"> product info info </p>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group row">
                <label class="col-sm-3 col-form-label">Product Name</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" name="productname"/>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group row">
                <label class="col-sm-3 col-form-label">Price</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" name="price"/>
                </div>
              </div>
            </div>
          </div> 
          
          <div class="row">
            <div class="row">
              <div class="col-md-6">
                <div class="form-group row">
                  <label class="col-sm-3 col-form-label">Category</label>
                  <div class="col-sm-9">
                    <select class="form-select" name="category" id="category" required>
                      <% category.forEach(category => { %>
                        <option value="<%= category._id %>"><%= category.category %></option>
                      <% }) %>
                    </select>
                  </div>
                </div>
              </div>
            </div>


            
            <div class="col-md-6">
              <div class="form-group row">
                <label class="col-sm-3 col-form-label">Size</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" name="size"/>
                </div>
              </div>
            </div>
          
          </div>
        
          <div class="row">
            <div class="col-md-6">
              <div class="form-group row">
                <label class="col-sm-3 col-form-label">Quantity</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" name="quantity" />
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group row">
                <label class="col-sm-3 col-form-label">Status</label>
                <div class="col-sm-4">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input type="radio" class="form-check-input" name="status" id="membershipRadios1" value=true checked> Active </label>
                  </div>
                </div>
                <div class="col-sm-5">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input type="radio" class="form-check-input" name="status" id="membershipRadios2" value="false"> InActive</label>
                  </div>
                </div>
              </div>
            </div>

           
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group row">
                <label class="col-sm-3 col-form-label">Description</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" name="description"/>
                </div>
              </div>
            </div>
            
      <h2>Product images</h2>
    <!-- input file -->
    <div class="box">
      <input type="file" id="file-input">
    </div>
    <!-- leftbox -->
    <div class="box-2">
      <div class="result"></div>
    </div>
    <!-- rightbox -->
    <div class="box-2 img-result hide">
      <!-- result of crop -->
      <img class="cropped" src="" alt="">
    </div>
    <!-- input file -->
    <div class="box">
      <div class="options hide">
        <input type="number" class="img-w" min="100" max="1200" name="image" />
      </div>
      <!-- save btn -->
      <button type="submit" class="btn save hide">Save</button>
      <!-- download btn -->
      <!-- <a href="" class="btn download hide">Download</a> -->
    </div>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
  <script>
    // vars
    let result = document.querySelector('.result'),
        img_result = document.querySelector('.img-result'),
        img_w = document.querySelector('.img-w'),
        img_h = document.querySelector('.img-h'),
        options = document.querySelector('.options'),
        save = document.querySelector('.save'),
        cropped = document.querySelector('.cropped'),
        dwn = document.querySelector('.download'),
        upload = document.querySelector('#file-input'),
        cropper = '';

    // on change show image with crop options
    upload.addEventListener('change', (e) => {
      if (e.target.files.length) {
        // start file reader
        const reader = new FileReader();
        reader.onload = (e) => {
          if (e.target.result) {
            // create new image
            let img = document.createElement('img');
            img.id = 'image';
            img.src = e.target.result
            // clean result before
            result.innerHTML = '';
            // append new image
            result.appendChild(img);
            // show save btn and options
            save.classList.remove('hide');
            options.classList.remove('hide');
            // init cropper
            cropper = new Cropper(img);
          }
        };
        reader.readAsDataURL(e.target.files[0]);
      }
    });

    // save on click
    save.addEventListener('click', (e) => {
      e.preventDefault();
      // get result to data uri
      let imgSrc = cropper.getCroppedCanvas({
        width: img_w.value // input value
      }).toDataURL();
      // remove hide class of img
      cropped.classList.remove('hide');
      img_result.classList.remove('hide');
      // show image cropped
      cropped.src = imgSrc;
      dwn.classList.remove('hide');
      dwn.download = 'imagename.png';
      dwn.setAttribute('href', imgSrc);
    });
  </script>
              </div>
            </div>

          <button class="btn btn-primary">Publish product</button>
        </form>
      </div>
    </div>
  </div>
</div>
</div>
</div>
</div>
</div>

<%- include('partials/footer')%>
